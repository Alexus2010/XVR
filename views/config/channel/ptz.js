var ptzVariables={currentChannel:0};function onLoad(){initDot();setTitle(lang.ptzconfig);initPtz()}function initPtz(){var a=$(".J-channel");getChannelProtocolType(function(b){if(isNVR()){initChannelSelect(a,getTotalChannelNum(),function(c){return b[c].enable})}else{if(isXVR()){initChannelSelect(a,getTotalChannelNum(),function(c){return vChannelConfig[c]===1})}}if(!$(".J-channel").val()){return $(".J-ptz-save").attr("disabled",true)}initPtzCb()})}function initPtzCb(){getPtzData();protolChange();initPtzEvent()}function initPtzEvent(){$(".J-channel").on("change",function(){channel=parseInt($(this).val());$(this).val()!=ptzVariables.currentChannel&&getPtzData(channel)});$("#protocolList").on("change",function(){protolChange()});setEditNumberStyle(".J-addr",false,null);$(".J-ptz-save").on("click",function(){onSavePtz()})}function getChannel(){var c=getTotalChannelNum(),d=[],b="";for(var a=0;a<c;a++){b=a>=9?"":0;if(window.top.vChannelConfig[a]==1||isNVR()){d.push({val:a,name:"CH"+b+(a+1)})}}return d}function getPtzData(a){a||(a=0);api.ptzConfig(REQUEST_GET,{channel:a},function(b,c){ptzVariables.currentChannel=a;autoFillValue("ptz",c);autoFillValue("serial",c.serial)})}function protolChange(){var a=$("#protocolList").val()>1?true:false;$(".disabled").attr("disabled",a)}function onSavePtz(){var a=getMatchValue("ptz"),b=a.channel,d=a.protocol,e=getMatchValue("serial");var c={channel:b,protocol:d,serial:e};api.ptzConfig(REQUEST_SET,c,function(f){showSaveMsg(f)})};