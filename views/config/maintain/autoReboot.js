function onLoad(){initDot();setTitle(lang.setTimeRestart);var a=$("#getautomaintainmin");for(var d=0;d<60;d++){a.append('<option value="'+d+'">'+zeroComplement(d)+"</option>")}var c=$("#getautomaintainhour");for(var d=0;d<24;d++){c.append('<option value="'+d+'">'+zeroComplement(d)+"</option>")}var e=$("#getautomaintainday");for(var d=1;d<=31;d++){var b=parseInt(d);e.append('<option value="'+d+'">'+zeroComplement(b)+"</option>")}if(isWifiNvr()){$("#blkWifiTip").show();$("#chkAllCh").parent().append(lang.allchannel+lang.channel);getChannPrivate()}else{$(".J-is-wifi-nvr").hide();$("#btnSave").click(function(){autorebootSave()})}loadAutoreboot();listenTimeChange()}function autorebootSave(){var a={type:parseInt($("#getautomaintaintype").val()),enableIpcReboot:$("#resSystemAndIpc").prop("checked"),day:parseInt($("#getautomaintainday").val()),week:parseInt($("#getautomaintainweek").val()),hour:parseInt($("#getautomaintainhour").val()),minute:parseInt($("#getautomaintainmin").val())};api.autoMaintain(REQUEST_SET,a,function(b,c){showSaveMsg(b);loading(false)})}function loadAutoreboot(){api.autoMaintain(REQUEST_GET,null,function(b,c){if(b!=CODE_SUCCESS){return}autoFillValue("maintain",c);var a=c.type;switch(a){case 1:$("#getautomaintainhour").show();$("#getautomaintainmin").show();$("#weekDay11").show();$("#weekDay12").show();break;case 2:$("#getautomaintainhour").show();$("#getautomaintainmin").show();$("#getautomaintainweek").show();$("#weekDay11").show();$("#weekDay12").show();break;case 3:$("#getautomaintainhour").show();$("#getautomaintainmin").show();$("#getautomaintainday").show();$("#weekDay11").show();$("#weekDay12").show();$("#weekDay10").show();break}$("#getautomaintaintype").show();split_span_val_type2(str)})}function listenTimeChange(){$("#getautomaintaintype").change(function(){switch($(this).val()){case"0":$("#getautomaintainhour").hide();$("#getautomaintainmin").hide();$("#getautomaintainday").hide();$("#getautomaintainweek").hide();$("#weekDay11").hide();$("#weekDay12").hide();$("#weekDay10").hide();break;case"1":$("#getautomaintainhour").hide();$("#getautomaintainmin").hide();$("#getautomaintainday").hide();$("#getautomaintainweek").hide();$("#weekDay11").hide();$("#weekDay12").hide();$("#weekDay10").hide();$("#getautomaintainhour").show();$("#getautomaintainmin").show();$("#weekDay11").show();$("#weekDay12").show();break;case"2":$("#getautomaintainhour").hide();$("#getautomaintainmin").hide();$("#getautomaintainday").hide();$("#getautomaintainweek").hide();$("#weekDay11").hide();$("#weekDay12").hide();$("#weekDay10").hide();$("#getautomaintainhour").show();$("#getautomaintainmin").show();$("#getautomaintainweek").show();$("#weekDay11").show();$("#weekDay12").show();break;case"3":$("#getautomaintainhour").hide();$("#getautomaintainmin").hide();$("#getautomaintainday").hide();$("#getautomaintainweek").hide();$("#weekDay11").hide();$("#weekDay12").hide();$("#weekDay10").hide();$("#getautomaintainhour").show();$("#getautomaintainmin").show();$("#getautomaintainday").show();$("#weekDay11").show();$("#weekDay12").show();$("#weekDay10").show();break}})}function getChannPrivate(){var b=getUserName();var a=getAuth();api.newGetCapability(REQUEST_GET,{username:b},function(d,h,j){var l=roundOne();var k=h.encryptionType[0];var i=roundTwo(b,h.param[k].salt,l[0],a);var g=reverseRoundThree(i);var f=roundFour(h.param[k].iterations,g);strSrcData4=roundFive(f);var e={encryptionType:k,loginName:String(b),datetime:l[1],iv:IV};api.channelList(REQUEST_GET,e,function(o,p){var r=p.channelList;var q=$("#listCh");var n=0;for(var m=0;m<r.length;m++){var c=$("<input type='checkbox'/>").data("ch",m).attr("disabled",r[m].protocolType=="Private"?false:true).click(onChClk);++n;$("<label class='pointer'></label>").append(c).append("&nbsp;"+(m+1)).appendTo(q)}$("#chkAllCh").click(onAllChClk);$("#btnSave").click(saveSetting);$("#chkAutoRsCh").change(function(){if($(this).prop("checked")){$("#chkRcCh").prop("checked",false);return setSaveEn(1)}$("#blkTwo input:checked").length===0&&setSaveEn(3)});$("#chkRcCh").change(function(){if($(this).prop("checked")){$("#chkAutoRsCh").prop("checked",false);return setSaveEn(1)}$("#blkTwo input:checked").length===0&&setSaveEn(3)});$("#listCh input").change(function(){if($(this).prop("checked")){return setSaveEn(2)}$("#listCh input:checked").length===0&&setSaveEn(3)});if(n===0){rightPopup(lang.nolimit);return q.html(lang.nolimit)}})})}function setSaveEn(b){var a;switch(b){case 1:a=$("#listCh input:checked").length===0;return $("#btnSave").prop("disabled",a);case 2:a=$("#blkTwo input:checked").length===0;return $("#btnSave").prop("disabled",a);case 3:a=!($("#blkTwo input:checked").length===0&&$("#listCh input:checked").length===0);return $("#btnSave").prop("disabled",a)}}function onChClk(){$("#chkAllCh").prop("checked",$("#listCh input:checked:enabled").length===$("#listCh input:enabled").length);setSaveEn(2);$("#listCh input:checked").length===0&&setSaveEn(3)}function onAllChClk(){$("#listCh input:enabled").prop("checked",$(this).prop("checked"));setSaveEn(2);$("#listCh input:checked").length===0&&setSaveEn(3)}function saveSetting(){loading(true);autorebootSave();var b=$("#listCh input:checked");if(!b.length){return}var a=$("#chkAutoRsCh").prop("checked"),d=$("#chkRcCh").prop("checked");if(!a&&!d){return}var c=[];$("#listCh input:checked").each(function(){var f=$(this).data("ch");c.push(f)});var e={channel:c,reboot:a,reset:d};api.ipcMaintain(REQUEST_SET,e,function(f,g){if(f!=CODE_SUCCESS){return}rightPopup(lang.setsuccessfully)})};