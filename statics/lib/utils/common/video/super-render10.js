"use strict";var vertexYUVShader=["attribute vec4 vertexPos;","attribute vec2 texturePos;","varying vec2 textureCoord;","void main()","{","gl_Position = vertexPos;","textureCoord = texturePos;","}"].join("\n"),fragmentYUVShader=["precision highp float;","varying highp vec2 textureCoord;","uniform sampler2D ySampler;","uniform sampler2D uSampler;","uniform sampler2D vSampler;","const mat4 YUV2RGB = mat4","(","1.1643828125, 0, 1.59602734375, -.87078515625,","1.1643828125, -.39176171875, -.81296875, .52959375,","1.1643828125, 2.017234375, 0, -1.081390625,","0, 0, 0, 1",");","void main(void) {","highp float y = texture2D(ySampler,  textureCoord).r;","highp float u = texture2D(uSampler,  textureCoord).r;","highp float v = texture2D(vSampler,  textureCoord).r;","gl_FragColor = vec4(y, u, v, 1) * YUV2RGB;","}"].join("\n");!function(b){function a(c){this.canvasElement=document.getElementById(c),this.initContextGL(),this.contextGL&&(this.YUVProgram=this.initProgram(vertexYUVShader,fragmentYUVShader),this.initBuffers(),this.initTextures())}b.SuperRender=(a.prototype.initContextGL=function(){var d=this.canvasElement,c=null;try{c=d.getContext("webgl")||d.getContext("experimental-webgl")}catch(d){c=null}c&&"function"==typeof c.getParameter||(c=null),this.contextGL=c,console.log("WebGL1.0")},a.prototype.initProgram=function(g,d){var f=this.contextGL,c=f.createShader(f.VERTEX_SHADER);f.shaderSource(c,g),f.compileShader(c),f.getShaderParameter(c,f.COMPILE_STATUS)||console.log("Vertex shader failed to compile: "+f.getShaderInfoLog(c));g=f.createShader(f.FRAGMENT_SHADER);f.shaderSource(g,d),f.compileShader(g),f.getShaderParameter(g,f.COMPILE_STATUS)||console.log("Fragment shader failed to compile: "+f.getShaderInfoLog(g));d=f.createProgram();return f.attachShader(d,c),f.attachShader(d,g),f.linkProgram(d),f.getProgramParameter(d,f.LINK_STATUS)||console.log("Program failed to compile: "+f.getProgramInfoLog(d)),f.deleteShader(c),f.deleteShader(g),d},a.prototype.initBuffers=function(){var f=this.contextGL,c=f.createBuffer();f.bindBuffer(f.ARRAY_BUFFER,c),f.bufferData(f.ARRAY_BUFFER,new Float32Array([1,1,-1,1,1,-1,-1,-1]),f.STATIC_DRAW),f.bindBuffer(f.ARRAY_BUFFER,null);var d=f.createBuffer();f.bindBuffer(f.ARRAY_BUFFER,d),f.bufferData(f.ARRAY_BUFFER,new Float32Array([1,0,0,0,1,1,0,1]),f.DYNAMIC_DRAW),f.bindBuffer(f.ARRAY_BUFFER,null),this.vertexPosBuffer=c,this.texturePosBuffer=d},a.prototype.initTextures=function(){var g=this.contextGL,d=this.YUVProgram;g.useProgram(d);var f=this.initTexture(),c=g.getUniformLocation(d,"ySampler");g.uniform1i(c,0),this.yTextureRef=f;c=this.initTexture(),f=g.getUniformLocation(d,"uSampler");g.uniform1i(f,1),this.uTextureRef=c;c=this.initTexture(),d=g.getUniformLocation(d,"vSampler");g.uniform1i(d,2),this.vTextureRef=c,g.useProgram(null)},a.prototype.initTexture=function(){var d=this.contextGL,c=d.createTexture();return d.bindTexture(d.TEXTURE_2D,c),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),d.bindTexture(d.TEXTURE_2D,null),c},a.prototype.SR_DisplayFrameData=function(h,l,c,g,j){if(!(h<=0||l<=0)){var d=this.contextGL;if(null==c){return d.clearColor(0,0,0,0),void d.clear(d.COLOR_BUFFER_BIT|d.DEPTH_BUFFER_BIT)}var f=this.canvasElement;f.width=h,f.height=l,this.nWindowWidth=f.width,this.nWindowHeight=f.height;var k=this.nWindowWidth,m=this.nWindowHeight;d.clearColor(0.8,0.8,1,1),d.clear(d.COLOR_BUFFER_BIT|d.DEPTH_BUFFER_BIT),d.viewport(0,0,k,m),this.updateFrameData(h,l,c);h=this.YUVProgram;d.useProgram(h);l=this.vertexPosBuffer;d.bindBuffer(d.ARRAY_BUFFER,l);c=d.getAttribLocation(h,"vertexPos");d.enableVertexAttribArray(c),d.vertexAttribPointer(c,2,d.FLOAT,!1,0,0),d.bindBuffer(d.ARRAY_BUFFER,null);l=this.texturePosBuffer;d.bindBuffer(d.ARRAY_BUFFER,l);h=d.getAttribLocation(h,"texturePos");d.enableVertexAttribArray(h),d.vertexAttribPointer(h,2,d.FLOAT,!1,0,0),d.bindBuffer(d.ARRAY_BUFFER,null),d.drawArrays(d.TRIANGLE_STRIP,0,4),d.disableVertexAttribArray(c),d.disableVertexAttribArray(h),d.useProgram(null),g&&j==this.captureId&&(this.capVideoData=f.toDataURL(),this.captureId="",this.capVideo=!1)}},a.prototype.updateFrameData=function(h,l,c){var g=this.contextGL,j=this.yTextureRef,d=this.uTextureRef,f=this.vTextureRef,k=c,m=h*l,c=k.subarray(0,m);g.activeTexture(g.TEXTURE0),g.bindTexture(g.TEXTURE_2D,j),g.texImage2D(g.TEXTURE_2D,0,g.LUMINANCE,h,l,0,g.LUMINANCE,g.UNSIGNED_BYTE,c);j=h/2*l/2,c=k.subarray(m,m+j);g.activeTexture(g.TEXTURE1),g.bindTexture(g.TEXTURE_2D,d),g.texImage2D(g.TEXTURE_2D,0,g.LUMINANCE,h/2,l/2,0,g.LUMINANCE,g.UNSIGNED_BYTE,c);j=k.subarray(m+j,m+j+j);g.activeTexture(g.TEXTURE2),g.bindTexture(g.TEXTURE_2D,f),g.texImage2D(g.TEXTURE_2D,0,g.LUMINANCE,h/2,l/2,0,g.LUMINANCE,g.UNSIGNED_BYTE,j)},a.prototype.SR_SetDisplayRect=function(j){var g,h,f=this.contextGL,c=this.nWindowWidth,k=this.nWindowHeight,l=null;l=j&&0<c&&0<k?(g=j.left/c,h=j.top/k,c=j.right/c,d=j.bottom/k,new Float32Array([c,h,g,h,c,d,g,d])):new Float32Array([1,0,0,0,1,1,0,1]);var d=this.texturePosBuffer;f.bindBuffer(f.ARRAY_BUFFER,d),f.bufferSubData(f.ARRAY_BUFFER,0,l),f.bindBuffer(f.ARRAY_BUFFER,null)},a.prototype.SR_Destroy=function(){var g=this.contextGL,d=this.YUVProgram;g.deleteProgram(d);var f=this.vertexPosBuffer,c=this.texturePosBuffer;g.deleteBuffer(f),g.deleteBuffer(c);d=this.yTextureRef,f=this.uTextureRef,c=this.vTextureRef;g.deleteTexture(d),g.deleteTexture(f),g.deleteTexture(c)},a)}(this);