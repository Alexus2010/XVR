!function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).AV=t()}(function(){return function i(s,n,a){function o(r,t){if(!n[r]){if(!s[r]){var e="function"==typeof require&&require;if(!t&&e)return e(r,!0);if(h)return h(r,!0);e=new Error("Cannot find module '"+r+"'");throw e.code="MODULE_NOT_FOUND",e}e=n[r]={exports:{}};s[r][0].call(e.exports,function(t){var e=s[r][1][t];return o(e||t)},e,e.exports,i,s,n,a)}return n[r].exports}for(var h="function"==typeof require&&require,t=0;t<a.length;t++)o(a[t]);return o}({1:[function(f,u,t){!function(){function i(t,e){return function(){return t.apply(e,arguments)}}var e,s,n,t,r,a,o={}.hasOwnProperty;function h(t){var e,r;this.source=t,this._decode=i(this._decode,this),this.findDecoder=i(this.findDecoder,this),this.probe=i(this.probe,this),this.buffered=0,this.duration=null,this.format=null,this.metadata=null,this.active=!1,this.demuxer=null,this.decoder=null,this.source.once("data",this.probe),this.source.on("error",(e=this,function(t){return e.emit("error",t),e.stop()})),this.source.on("progress",(r=this,function(t){return r.buffered=t,r.emit("buffer",r.buffered)}))}t=f("./core/events"),a=f("./sources/node/http"),r=f("./sources/node/file"),e=f("./sources/buffer"),n=f("./demuxer"),s=f("./decoder"),function(t,e){for(var r in e)o.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(h,t),h.fromURL=function(t,e){return new h(new a(t,e))},h.fromFile=function(t){return new h(new r(t))},h.fromBuffer=function(t){return new h(new e(t))},h.prototype.start=function(t){if(!this.active)return null!=t&&(this.shouldDecode=t),null==this.shouldDecode&&(this.shouldDecode=!0),this.active=!0,this.source.start(),this.decoder&&this.shouldDecode?this._decode():void 0},h.prototype.stop=function(){if(this.active)return this.active=!1,this.source.pause()},h.prototype.get=function(t,e){var r;if("format"===t||"duration"===t||"metadata"===t)return null!=this[t]?e(this[t]):(this.once(t,(r=this,function(t){return r.stop(),e(t)})),this.start())},h.prototype.decodePacket=function(){return this.decoder.decode()},h.prototype.decodeToBuffer=function(n){var a,o=0,h=[];return this.on("data",a=function(t){return o+=t.length,h.push(t)}),this.once("end",function(){for(var t,e=new Float32Array(o),r=0,i=0,s=h.length;i<s;i++)t=h[i],e.set(t,r),r+=t.length;return this.off("data",a),n(e)}),this.start()},h.prototype.probe=function(t){var e,r,i,s;if(this.active)return(e=n.find(t))?(this.demuxer=new e(this.source,t),this.demuxer.on("format",this.findDecoder),this.demuxer.on("duration",(r=this,function(t){return r.duration=t,r.emit("duration",r.duration)})),this.demuxer.on("metadata",(i=this,function(t){return i.metadata=t,i.emit("metadata",i.metadata)})),this.demuxer.on("error",(s=this,function(t){return s.emit("error",t),s.stop()}))):this.emit("error","A demuxer for this container was not found.")},h.prototype.findDecoder=function(t){var a,o,e,r,i;if(this.format=t,this.active)return this.emit("format",this.format),(t=s.find(this.format.formatID))?(this.decoder=new t(this.demuxer,this.format),this.format.floatingPoint?this.decoder.on("data",(e=this,function(t){return e.emit("data",t)})):(a=Math.pow(2,this.format.bitsPerChannel-1),this.decoder.on("data",(o=this,function(t){for(var e,r,i=new Float32Array(t.length),s=e=0,n=t.length;e<n;s=++e)r=t[s],i[s]=r/a;return o.emit("data",i)}))),this.decoder.on("error",(r=this,function(t){return r.emit("error",t),r.stop()})),this.decoder.on("end",(i=this,function(){return i.emit("end")})),this.emit("decodeStart"),this.shouldDecode?this._decode():void 0):this.emit("error","A decoder for "+this.format.formatID+" was not found.")},h.prototype._decode=function(){for(;this.decoder.decode()&&this.active;);if(this.active)return this.decoder.once("data",this._decode)},h.prototype.destroy=function(){var t;return this.stop(),null!=(t=this.demuxer)&&t.off(),null!=(t=this.decoder)&&t.off(),null!=(t=this.source)&&t.off(),this.off()},u.exports=h}.call(this)},{"./core/events":8,"./decoder":11,"./demuxer":14,"./sources/buffer":31,"./sources/node/file":29,"./sources/node/http":30}],2:[function(i,t,s){!function(){var t,e,r=i("./aurora_base");for(t in r)e=r[t],s[t]=e;i("./demuxers/caf"),i("./demuxers/m4a"),i("./demuxers/aiff"),i("./demuxers/wave"),i("./demuxers/au"),i("./decoders/lpcm"),i("./decoders/xlaw")}.call(this)},{"./aurora_base":3,"./decoders/lpcm":12,"./decoders/xlaw":13,"./demuxers/aiff":15,"./demuxers/au":16,"./demuxers/caf":17,"./demuxers/m4a":18,"./demuxers/wave":19}],3:[function(t,e,r){!function(){r.Base=t("./core/base"),r.Buffer=t("./core/buffer"),r.BufferList=t("./core/bufferlist"),r.Stream=t("./core/stream"),r.Bitstream=t("./core/bitstream"),r.EventEmitter=t("./core/events"),r.UnderflowError=t("./core/underflow"),r.HTTPSource=t("./sources/node/http"),r.FileSource=t("./sources/node/file"),r.BufferSource=t("./sources/buffer"),r.Demuxer=t("./demuxer"),r.Decoder=t("./decoder"),r.AudioDevice=t("./device"),r.Asset=t("./asset"),r.Player=t("./player"),r.Filter=t("./filter"),r.VolumeFilter=t("./filters/volume"),r.BalanceFilter=t("./filters/balance")}.call(this)},{"./asset":1,"./core/base":4,"./core/bitstream":5,"./core/buffer":6,"./core/bufferlist":7,"./core/events":8,"./core/stream":9,"./core/underflow":10,"./decoder":11,"./demuxer":14,"./device":20,"./filter":24,"./filters/balance":25,"./filters/volume":26,"./player":27,"./sources/buffer":31,"./sources/node/file":29,"./sources/node/http":30}],4:[function(t,e,r){!function(){var h,f={}.hasOwnProperty,u=[].indexOf||function(t){for(var e=0,r=this.length;e<r;e++)if(e in this&&this[e]===t)return e;return-1};function t(){}h=/\b_super\b/,t.extend=function(t){var e,s,r,i,n,a;function o(){return o.__super__.constructor.apply(this,arguments)}if(function(t,e){for(var r in e)f.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(o,this),e=o,"function"==typeof t)for(i in n=Object.keys(e.prototype),t.call(e,e),t={},a=e.prototype)r=a[i],u.call(n,i)<0&&(t[i]=r);for(i in s=e.__super__,t)"function"==typeof(r=t[i])&&h.test(r)?function(r,i){e.prototype[r]=function(){var t,e=this._super;return this._super=s[r],t=i.apply(this,arguments),this._super=e,t}}(i,r):e.prototype[i]=r;return e},e.exports=t}.call(this)},{}],5:[function(t,r,e){!function(){function e(t){this.stream=t,this.bitPosition=0}e.prototype.copy=function(){var t=new e(this.stream.copy());return t.bitPosition=this.bitPosition,t},e.prototype.offset=function(){return 8*this.stream.offset+this.bitPosition},e.prototype.available=function(t){return this.stream.available((t+8-this.bitPosition)/8)},e.prototype.advance=function(t){t=this.bitPosition+t;return this.stream.advance(t>>3),this.bitPosition=7&t},e.prototype.rewind=function(t){t=this.bitPosition-t;return this.stream.rewind(Math.abs(t>>3)),this.bitPosition=7&t},e.prototype.seek=function(t){var e=this.offset();return e<t?this.advance(t-e):t<e?this.rewind(e-t):void 0},e.prototype.align=function(){if(0!==this.bitPosition)return this.bitPosition=0,this.stream.advance(1)},e.prototype.read=function(t,e){var r,i;if(0===t)return 0;if((i=t+this.bitPosition)<=8)r=(this.stream.peekUInt8()<<this.bitPosition&255)>>>8-t;else if(i<=16)r=(this.stream.peekUInt16()<<this.bitPosition&65535)>>>16-t;else if(i<=24)r=(this.stream.peekUInt24()<<this.bitPosition&16777215)>>>24-t;else if(i<=32)r=this.stream.peekUInt32()<<this.bitPosition>>>32-t;else{if(!(i<=40))throw new Error("Too many bits!");r=4294967296*this.stream.peekUInt8(0)+(this.stream.peekUInt8(1)<<24>>>0)+(this.stream.peekUInt8(2)<<16)+(this.stream.peekUInt8(3)<<8)+this.stream.peekUInt8(4),r%=Math.pow(2,40-this.bitPosition),r=Math.floor(r/Math.pow(2,40-this.bitPosition-t))}return e&&(i<32?r>>>t-1&&(r=-1*((1<<t>>>0)-r)):r/Math.pow(2,t-1)|0&&(r=-1*(Math.pow(2,t)-r))),this.advance(t),r},e.prototype.peek=function(t,e){var r,i;if(0===t)return 0;if((i=t+this.bitPosition)<=8)r=(this.stream.peekUInt8()<<this.bitPosition&255)>>>8-t;else if(i<=16)r=(this.stream.peekUInt16()<<this.bitPosition&65535)>>>16-t;else if(i<=24)r=(this.stream.peekUInt24()<<this.bitPosition&16777215)>>>24-t;else if(i<=32)r=this.stream.peekUInt32()<<this.bitPosition>>>32-t;else{if(!(i<=40))throw new Error("Too many bits!");r=4294967296*this.stream.peekUInt8(0)+(this.stream.peekUInt8(1)<<24>>>0)+(this.stream.peekUInt8(2)<<16)+(this.stream.peekUInt8(3)<<8)+this.stream.peekUInt8(4),r%=Math.pow(2,40-this.bitPosition),r=Math.floor(r/Math.pow(2,40-this.bitPosition-t))}return e&&(i<32?r>>>t-1&&(r=-1*((1<<t>>>0)-r)):r/Math.pow(2,t-1)|0&&(r=-1*(Math.pow(2,t)-r))),r},e.prototype.readLSB=function(t,e){var r,i;if(0===t)return 0;if(40<t)throw new Error("Too many bits!");return i=t+this.bitPosition,r=this.stream.peekUInt8(0)>>>this.bitPosition,8<i&&(r|=this.stream.peekUInt8(1)<<8-this.bitPosition),16<i&&(r|=this.stream.peekUInt8(2)<<16-this.bitPosition),24<i&&(r+=this.stream.peekUInt8(3)<<24-this.bitPosition>>>0),32<i&&(r+=this.stream.peekUInt8(4)*Math.pow(2,32-this.bitPosition)),32<=i?r%=Math.pow(2,t):r&=(1<<t)-1,e&&(i<32?r>>>t-1&&(r=-1*((1<<t>>>0)-r)):r/Math.pow(2,t-1)|0&&(r=-1*(Math.pow(2,t)-r))),this.advance(t),r},e.prototype.peekLSB=function(t,e){var r,i;if(0===t)return 0;if(40<t)throw new Error("Too many bits!");return i=t+this.bitPosition,r=this.stream.peekUInt8(0)>>>this.bitPosition,8<i&&(r|=this.stream.peekUInt8(1)<<8-this.bitPosition),16<i&&(r|=this.stream.peekUInt8(2)<<16-this.bitPosition),24<i&&(r+=this.stream.peekUInt8(3)<<24-this.bitPosition>>>0),32<i&&(r+=this.stream.peekUInt8(4)*Math.pow(2,32-this.bitPosition)),32<=i?r%=Math.pow(2,t):r&=(1<<t)-1,e&&(i<32?r>>>t-1&&(r=-1*((1<<t>>>0)-r)):r/Math.pow(2,t-1)|0&&(r=-1*(Math.pow(2,t)-r))),r},r.exports=e}.call(this)},{}],6:[function(t,e,r){!function(n){!function(){var i,r;function s(t){var e;if(t instanceof Uint8Array)this.data=t;else if(t instanceof ArrayBuffer||Array.isArray(t)||"number"==typeof t||null!=(e=n.Buffer)&&e.isBuffer(t))this.data=new Uint8Array(t);else if(t.buffer instanceof ArrayBuffer)this.data=new Uint8Array(t.buffer,t.byteOffset,t.length*t.BYTES_PER_ELEMENT);else{if(!(t instanceof s))throw new Error("Constructing buffer with unknown type.");this.data=t.data}this.length=this.data.length,this.next=null,this.prev=null}s.allocate=function(t){return new s(t)},s.prototype.copy=function(){return new s(new Uint8Array(this.data))},s.prototype.slice=function(t,e){return null==e&&(e=this.length),0===t&&e>=this.length?new s(this.data):new s(this.data.subarray(t,t+e))},i=n.BlobBuilder||n.MozBlobBuilder||n.WebKitBlobBuilder,r=n.URL||n.webkitURL||n.mozURL,s.makeBlob=function(t,e){var r;null==e&&(e="application/octet-stream");try{return new Blob([t],{type:e})}catch(t){}return null!=i?((r=new i).append(t),r.getBlob(e)):null},s.makeBlobURL=function(t,e){return null!=r?r.createObjectURL(this.makeBlob(t,e)):void 0},s.revokeBlobURL=function(t){return null!=r?r.revokeObjectURL(t):void 0},s.prototype.toBlob=function(){return s.makeBlob(this.data.buffer)},s.prototype.toBlobURL=function(){return s.makeBlobURL(this.data.buffer)},e.exports=s}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],7:[function(t,r,e){!function(){function e(){this.first=null,this.last=null,this.numBuffers=0,this.availableBytes=0,this.availableBuffers=0}e.prototype.copy=function(){var t=new e;return t.first=this.first,t.last=this.last,t.numBuffers=this.numBuffers,t.availableBytes=this.availableBytes,t.availableBuffers=this.availableBuffers,t},e.prototype.append=function(t){var e;if(t)return t.prev=this.last,null!=(e=this.last)&&(e.next=t),this.last=t,null==this.first&&(this.first=t),this.availableBytes+=t.length,this.availableBuffers++,this.numBuffers++},e.prototype.advance=function(){return!!this.first&&(this.availableBytes-=this.first.length,this.availableBuffers--,this.first=this.first.next,null!=this.first)},e.prototype.rewind=function(){var t;return!(this.first&&!this.first.prev)&&(this.first=(null!=(t=this.first)?t.prev:void 0)||this.last,this.first&&(this.availableBytes+=this.first.length,this.availableBuffers++),null!=this.first)},e.prototype.reset=function(){for(var t=[];this.rewind(););return t},r.exports=e}.call(this)},{}],8:[function(e,r,t){!function(){var s={}.hasOwnProperty,a=[].slice;function t(){return t.__super__.constructor.apply(this,arguments)}(function(t,e){for(var r in e)s.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype})(t,e("./base")),t.prototype.on=function(t,e){var r;return null==this.events&&(this.events={}),null==(r=this.events)[t]&&(r[t]=[]),this.events[t].push(e)},t.prototype.off=function(t,e){var r;if(null!=this.events)return null!=(r=this.events)&&r[t]?null==e?this.events[t]:~(e=this.events[t].indexOf(e))?this.events[t].splice(e,1):void 0:null==t?{}:void 0},t.prototype.once=function(t,e){var r;return this.on(t,r=function(){return this.off(t,r),e.apply(this,arguments)})},t.prototype.emit=function(){var t,e,r,i,s=arguments[0],n=2<=arguments.length?a.call(arguments,1):[];if(null!=(r=this.events)&&r[s])for(t=0,e=(i=this.events[s].slice()).length;t<e;t++)i[t].apply(this,n)},r.exports=t}.call(this)},{"./base":4}],9:[function(y,k,t){!function(){var o,r,i,t,s,n,a,h,f,u,l,e,c,p,d,m;function v(t){this.list=t,this.localOffset=0,this.offset=0}r=y("./bufferlist"),o=y("./buffer"),i=y("./underflow"),t=new ArrayBuffer(16),m=new Uint8Array(t),e=new Int8Array(t),p=new Uint16Array(t),u=new Int16Array(t),d=new Uint32Array(t),l=new Int32Array(t),n=new Float32Array(t),"undefined"!=typeof Float64Array&&null!==Float64Array&&(a=new Float64Array(t)),c=13330===new Uint16Array(new Uint8Array([18,52]).buffer)[0],v.fromBuffer=function(t){var e=new r;return e.append(t),new v(e)},v.prototype.copy=function(){var t=new v(this.list.copy());return t.localOffset=this.localOffset,t.offset=this.offset,t},v.prototype.available=function(t){return t<=this.list.availableBytes-this.localOffset},v.prototype.remainingBytes=function(){return this.list.availableBytes-this.localOffset},v.prototype.advance=function(t){if(!this.available(t))throw new i;for(this.localOffset+=t,this.offset+=t;this.list.first&&this.localOffset>=this.list.first.length;)this.localOffset-=this.list.first.length,this.list.advance();return this},v.prototype.rewind=function(t){if(t>this.offset)throw new i;for(this.list.first||(this.list.rewind(),this.localOffset=this.list.first.length),this.localOffset-=t,this.offset-=t;this.list.first.prev&&this.localOffset<0;)this.list.rewind(),this.localOffset+=this.list.first.length;return this},v.prototype.seek=function(t){return t>this.offset?this.advance(t-this.offset):t<this.offset?this.rewind(this.offset-t):void 0},v.prototype.readUInt8=function(){var t;if(!this.available(1))throw new i;return t=this.list.first.data[this.localOffset],this.localOffset+=1,this.offset+=1,this.localOffset===this.list.first.length&&(this.localOffset=0,this.list.advance()),t},v.prototype.peekUInt8=function(t){var e;if(!this.available((t=null==t?0:t)+1))throw new i;for(t=this.localOffset+t,e=this.list.first;e;){if(e.length>t)return e.data[t];t-=e.length,e=e.next}return 0},v.prototype.read=function(t,e){var r,i,s,n;if((e=null==e?!1:e)===c)for(r=i=0,n=t;i<n;r=i+=1)m[r]=this.readUInt8();else for(r=s=t-1;0<=s;r=s+=-1)m[r]=this.readUInt8()},v.prototype.peek=function(t,e,r){var i,s,n,a,o;if((r=null==r?!1:r)===c)for(i=s=0,a=t;s<a;i=s+=1)m[i]=this.peekUInt8(e+i);else for(i=n=0,o=t;n<o;i=n+=1)m[t-i-1]=this.peekUInt8(e+i)},v.prototype.readInt8=function(){return this.read(1),e[0]},v.prototype.peekInt8=function(t){return this.peek(1,t=null==t?0:t),e[0]},v.prototype.readUInt16=function(t){return this.read(2,t),p[0]},v.prototype.peekUInt16=function(t,e){return this.peek(2,t=null==t?0:t,e),p[0]},v.prototype.readInt16=function(t){return this.read(2,t),u[0]},v.prototype.peekInt16=function(t,e){return this.peek(2,t=null==t?0:t,e),u[0]},v.prototype.readUInt24=function(t){return t?this.readUInt16(!0)+(this.readUInt8()<<16):(this.readUInt16()<<8)+this.readUInt8()},v.prototype.peekUInt24=function(t,e){return null==t&&(t=0),e?this.peekUInt16(t,!0)+(this.peekUInt8(t+2)<<16):(this.peekUInt16(t)<<8)+this.peekUInt8(t+2)},v.prototype.readInt24=function(t){return t?this.readUInt16(!0)+(this.readInt8()<<16):(this.readInt16()<<8)+this.readUInt8()},v.prototype.peekInt24=function(t,e){return null==t&&(t=0),e?this.peekUInt16(t,!0)+(this.peekInt8(t+2)<<16):(this.peekInt16(t)<<8)+this.peekUInt8(t+2)},v.prototype.readUInt32=function(t){return this.read(4,t),d[0]},v.prototype.peekUInt32=function(t,e){return this.peek(4,t=null==t?0:t,e),d[0]},v.prototype.readInt32=function(t){return this.read(4,t),l[0]},v.prototype.peekInt32=function(t,e){return this.peek(4,t=null==t?0:t,e),l[0]},v.prototype.readFloat32=function(t){return this.read(4,t),n[0]},v.prototype.peekFloat32=function(t,e){return this.peek(4,t=null==t?0:t,e),n[0]},v.prototype.readFloat64=function(t){return this.read(8,t),a?a[0]:h()},h=function(){var t,e,r=d[0],i=d[1];return i&&2147483648!==i?(e=1-2*(i>>>31),t=1048575&i,2047==(i=i>>>20&2047)?t?NaN:1/0*e:(i-=1023,t=(1048576|t)*Math.pow(2,i-20),e*(t+=r*Math.pow(2,i-52)))):0},v.prototype.peekFloat64=function(t,e){return this.peek(8,t=null==t?0:t,e),a?a[0]:h()},v.prototype.readFloat80=function(t){return this.read(10,t),f()},f=function(){var t=d[0],e=d[1],r=m[9],i=1-2*(r>>>7),r=(127&r)<<8|m[8];return 0==r&&0===e&&0===t?0:32767==r?0===e&&0===t?1/0*i:NaN:(r-=16383,e=e*Math.pow(2,r-31),i*(e+=t*Math.pow(2,r-63)))},v.prototype.peekFloat80=function(t,e){return this.peek(10,t=null==t?0:t,e),f()},v.prototype.readBuffer=function(t){for(var e,r=o.allocate(t),i=r.data,s=e=0,n=t;e<n;s=e+=1)i[s]=this.readUInt8();return r},v.prototype.peekBuffer=function(t,e){var r,i,s,n,a;for(null==t&&(t=0),a=(n=o.allocate(e)).data,r=i=0,s=e;i<s;r=i+=1)a[r]=this.peekUInt8(t+r);return n},v.prototype.readSingleBuffer=function(t){t=this.list.first.slice(this.localOffset,t);return this.advance(t.length),t},v.prototype.peekSingleBuffer=function(t,e){return this.list.first.slice(this.localOffset+t,e)},v.prototype.readString=function(t,e){return s.call(this,0,t,e=null==e?"ascii":e,!0)},v.prototype.peekString=function(t,e,r){return s.call(this,t=null==t?0:t,e,r=null==r?"ascii":r,!1)},s=function(t,e,r,i){var s,n,a,o,h,f,u,l,c,p=null===e?0:-1,d=t+(e=null==e?1/0:e),m="";switch(r=r.toLowerCase()){case"ascii":case"latin1":for(;t<d&&(h=this.peekUInt8(t++))!==p;)m+=String.fromCharCode(h);break;case"utf8":case"utf-8":for(;t<d&&(s=this.peekUInt8(t++))!==p;)0==(128&s)?m+=String.fromCharCode(s):192==(224&s)?(n=63&this.peekUInt8(t++),m+=String.fromCharCode((31&s)<<6|n)):224==(240&s)?(n=63&this.peekUInt8(t++),a=63&this.peekUInt8(t++),m+=String.fromCharCode((15&s)<<12|n<<6|a)):240==(248&s)&&(u=((15&s)<<18|(n=63&this.peekUInt8(t++))<<12|(a=63&this.peekUInt8(t++))<<6|63&this.peekUInt8(t++))-65536,m+=String.fromCharCode(55296+(u>>10),56320+(1023&u)));break;case"utf16-be":case"utf16be":case"utf16le":case"utf16-le":case"utf16bom":case"utf16-bom":switch(r){case"utf16be":case"utf16-be":f=!1;break;case"utf16le":case"utf16-le":f=!0;break;case"utf16bom":case"utf16-bom":if(e<2||(o=this.peekUInt16(t))===p)return i&&this.advance(t+=2),m;f=65534===o,t+=2}for(;t<d&&(l=this.peekUInt16(t,f))!==p;)if(t+=2,l<55296||57343<l)m+=String.fromCharCode(l);else{if(56319<l)throw new Error("Invalid utf16 sequence.");if((c=this.peekUInt16(t,f))<56320||57343<c)throw new Error("Invalid utf16 sequence.");m+=String.fromCharCode(l,c),t+=2}l===p&&(t+=2);break;default:throw new Error("Unknown encoding: "+r)}return i&&this.advance(t),m},k.exports=v}.call(this)},{"./buffer":6,"./bufferlist":7,"./underflow":10}],10:[function(t,e,r){!function(){var s={}.hasOwnProperty;function t(){t.__super__.constructor.apply(this,arguments),this.name="UnderflowError",this.stack=(new Error).stack}(function(t,e){for(var r in e)s.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype})(t,Error),e.exports=t}.call(this)},{}],11:[function(n,f,t){!function(){var a,o,t,h,r,i,s={}.hasOwnProperty;function e(t,e){var r,i,s,n;this.demuxer=t,this.format=e,r=new o,this.stream=new h(r),this.bitstream=new a(this.stream),this.receivedFinalBuffer=!1,this.waiting=!1,this.demuxer.on("cookie",(i=this,function(t){try{return i.setCookie(t)}catch(t){return i.emit("error",t)}})),this.demuxer.on("data",(s=this,function(t){if(r.append(t),s.waiting)return s.decode()})),this.demuxer.on("end",(n=this,function(){if(n.receivedFinalBuffer=!0,n.waiting)return n.decode()})),this.init()}t=n("./core/events"),o=n("./core/bufferlist"),h=n("./core/stream"),a=n("./core/bitstream"),r=n("./core/underflow"),function(t,e){for(var r in e)s.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(e,t),e.prototype.init=function(){},e.prototype.setCookie=function(t){},e.prototype.readChunk=function(){},e.prototype.decode=function(){var t,e;this.waiting=!this.receivedFinalBuffer,t=this.bitstream.offset();try{e=this.readChunk()}catch(t){if(!(t instanceof r))return this.emit("error",t),!1}return e?(this.emit("data",e),this.receivedFinalBuffer&&this.emit("end"),!0):(this.receivedFinalBuffer?this.emit("end"):(this.bitstream.seek(t),this.waiting=!0),!1)},e.prototype.seek=function(t){t=this.demuxer.seek(t);return this.stream.seek(t.offset),t.timestamp},i={},e.register=function(t,e){return i[t]=e},e.find=function(t){return i[t]||null},f.exports=e}.call(this)},{"./core/bitstream":5,"./core/bufferlist":7,"./core/events":8,"./core/stream":9,"./core/underflow":10}],12:[function(i,t,e){!function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},s={}.hasOwnProperty;function r(){return this.readChunk=e(this.readChunk,this),r.__super__.constructor.apply(this,arguments)}(function(t,e){for(var r in e)s.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype})(r,t=i("../decoder")),t.register("lpcm",r),r.prototype.readChunk=function(){var t,e,r,i,s,n,a,o,h,f,u,l,c,p,d=this.stream,m=this.format.littleEndian,v=Math.min(4096,d.remainingBytes()),y=v/(this.format.bitsPerChannel/8)|0;if(v<this.format.bitsPerChannel/8)return null;if(this.format.floatingPoint)switch(this.format.bitsPerChannel){case 32:for(o=new Float32Array(y),t=e=0,h=y;e<h;t=e+=1)o[t]=d.readFloat32(m);break;case 64:for(o=new Float64Array(y),t=r=0,f=y;r<f;t=r+=1)o[t]=d.readFloat64(m);break;default:throw new Error("Unsupported bit depth.")}else switch(this.format.bitsPerChannel){case 8:for(o=new Int8Array(y),t=i=0,u=y;i<u;t=i+=1)o[t]=d.readInt8();break;case 16:for(o=new Int16Array(y),t=s=0,l=y;s<l;t=s+=1)o[t]=d.readInt16(m);break;case 24:for(o=new Int32Array(y),t=n=0,c=y;n<c;t=n+=1)o[t]=d.readInt24(m);break;case 32:for(o=new Int32Array(y),t=a=0,p=y;a<p;t=a+=1)o[t]=d.readInt32(m);break;default:throw new Error("Unsupported bit depth.")}return o}}.call(this)},{"../decoder":11}],13:[function(i,t,e){!function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},s={}.hasOwnProperty;function r(){return this.readChunk=e(this.readChunk,this),r.__super__.constructor.apply(this,arguments)}(function(t,e){for(var r in e)s.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype})(r,t=i("../decoder")),t.register("ulaw",r),t.register("alaw",r),r.prototype.init=function(){var t,e,r,i,s,n,a;if(this.format.bitsPerChannel=16,this.table=n=new Int16Array(256),"ulaw"===this.format.formatID)for(t=e=0;e<256;t=++e)s=132+((15&(a=~t))<<3),s<<=(112&a)>>>4,n[t]=128&a?132-s:s-132;else for(t=r=0;r<256;t=++r)s=15&(a=85^t),s=(i=(112&a)>>>4)?s+s+1+32<<2+i:s+s+1<<3,n[t]=128&a?s:-s},r.prototype.readChunk=function(){var t,e,r,i,s=this.stream,n=this.table,a=Math.min(4096,this.stream.remainingBytes());if(0!==a){for(r=new Int16Array(a),t=e=0,i=a;e<i;t=e+=1)r[t]=n[s.readUInt8()];return r}}}.call(this)},{"../decoder":11}],14:[function(r,i,t){!function(){var o,t,h,a,s={}.hasOwnProperty;function e(t,e){var r,i,s,n,a=new o;a.append(e),this.stream=new h(a),r=!1,t.on("data",(i=this,function(t){r=!0,a.append(t);try{return i.readChunk(t)}catch(t){return i.emit("error",t)}})),t.on("error",(s=this,function(t){return s.emit("error",t)})),t.on("end",(n=this,function(){return r||n.readChunk(e),n.emit("end")})),this.seekPoints=[],this.init()}t=r("./core/events"),o=r("./core/bufferlist"),h=r("./core/stream"),function(t,e){for(var r in e)s.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(e,t),e.probe=function(t){return!1},e.prototype.init=function(){},e.prototype.readChunk=function(t){},e.prototype.addSeekPoint=function(t,e){var r=this.searchTimestamp(e);return this.seekPoints.splice(r,0,{offset:t,timestamp:e})},e.prototype.searchTimestamp=function(t,e){var r,i,s=0,n=this.seekPoints.length;if(0<n&&this.seekPoints[n-1].timestamp<t)return n;for(;s<n;)(i=this.seekPoints[r=s+n>>1].timestamp)<t?s=1+r:t<=i&&(n=r);return n=n>this.seekPoints.length?this.seekPoints.length:n},e.prototype.seek=function(t){return this.format&&0<this.format.framesPerPacket&&0<this.format.bytesPerPacket?{timestamp:t,offset:this.format.bytesPerPacket*t/this.format.framesPerPacket}:(t=this.searchTimestamp(t),this.seekPoints[t])},a=[],e.register=function(t){return a.push(t)},e.find=function(t){for(var e,r,i=h.fromBuffer(t),s=0,n=a.length;s<n;s++){e=a[s],r=i.offset;try{if(e.probe(i))return e}catch(t){0}i.seek(r)}return null},i.exports=e}.call(this)},{"./core/bufferlist":7,"./core/events":8,"./core/stream":9}],15:[function(r,t,e){!function(){var t,s={}.hasOwnProperty;function e(){return e.__super__.constructor.apply(this,arguments)}(function(t,e){for(var r in e)s.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype})(e,t=r("../demuxer")),t.register(e),e.probe=function(t){return"FORM"===t.peekString(0,4)&&("AIFF"===(t=t.peekString(8,4))||"AIFC"===t)},e.prototype.readChunk=function(){var t,e,r;if(!this.readStart&&this.stream.available(12)){if("FORM"!==this.stream.readString(4))return this.emit("error","Invalid AIFF.");if(this.fileSize=this.stream.readUInt32(),this.fileType=this.stream.readString(4),this.readStart=!0,"AIFF"!==(r=this.fileType)&&"AIFC"!==r)return this.emit("error","Invalid AIFF.")}for(;this.stream.available(1);){switch(!this.readHeaders&&this.stream.available(8)&&(this.type=this.stream.readString(4),this.len=this.stream.readUInt32()),this.type){case"COMM":if(!this.stream.available(this.len))return;this.format={formatID:"lpcm",channelsPerFrame:this.stream.readUInt16(),sampleCount:this.stream.readUInt32(),bitsPerChannel:this.stream.readUInt16(),sampleRate:this.stream.readFloat80(),framesPerPacket:1,littleEndian:!1,floatingPoint:!1},this.format.bytesPerPacket=this.format.bitsPerChannel/8*this.format.channelsPerFrame,"AIFC"===this.fileType&&(t=this.stream.readString(4),this.format.littleEndian="sowt"===t&&8<this.format.bitsPerChannel,this.format.floatingPoint="fl32"===t||"fl64"===t,"twos"!==t&&"sowt"!==t&&"fl32"!==t&&"fl64"!==t&&"NONE"!==t||(t="lpcm"),this.format.formatID=t,this.len-=4),this.stream.advance(this.len-18),this.emit("format",this.format),this.emit("duration",this.format.sampleCount/this.format.sampleRate*1e3|0);break;case"SSND":this.readSSNDHeader&&this.stream.available(4)||(e=this.stream.readUInt32(),this.stream.advance(4),this.stream.advance(e),this.readSSNDHeader=!0),e=this.stream.readSingleBuffer(this.len),this.len-=e.length,this.readHeaders=0<this.len,this.emit("data",e);break;default:if(!this.stream.available(this.len))return;this.stream.advance(this.len)}"SSND"!==this.type&&(this.readHeaders=!1)}}}.call(this)},{"../demuxer":14}],16:[function(n,t,e){!function(){var t,r,i,s={}.hasOwnProperty;function e(){return e.__super__.constructor.apply(this,arguments)}(function(t,e){for(var r in e)s.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype})(e,t=n("../demuxer")),t.register(e),e.probe=function(t){return".snd"===t.peekString(0,4)},(r=[8,8,16,24,32,32,64])[26]=8,i={1:"ulaw",27:"alaw"},e.prototype.readChunk=function(){var t,e;if(!this.readHeader&&this.stream.available(24)){if(".snd"!==this.stream.readString(4))return this.emit("error","Invalid AU file.");if(this.stream.readUInt32(),t=this.stream.readUInt32(),e=this.stream.readUInt32(),this.format={formatID:i[e]||"lpcm",littleEndian:!1,floatingPoint:6===e||7===e,bitsPerChannel:r[e-1],sampleRate:this.stream.readUInt32(),channelsPerFrame:this.stream.readUInt32(),framesPerPacket:1},null==this.format.bitsPerChannel)return this.emit("error","Unsupported encoding in AU file.");this.format.bytesPerPacket=this.format.bitsPerChannel/8*this.format.channelsPerFrame,4294967295!==t&&(e=this.format.bitsPerChannel/8,this.emit("duration",t/e/this.format.channelsPerFrame/this.format.sampleRate*1e3|0)),this.emit("format",this.format),this.readHeader=!0}if(this.readHeader)for(;this.stream.available(1);)this.emit("data",this.stream.readSingleBuffer(this.stream.remainingBytes()))}}.call(this)},{"../demuxer":14}],17:[function(r,t,e){!function(){var t,p,s={}.hasOwnProperty;function e(){return e.__super__.constructor.apply(this,arguments)}t=r("../demuxer"),p=r("./m4a"),function(t,e){for(var r in e)s.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(e,t),t.register(e),e.probe=function(t){return"caff"===t.peekString(0,4)},e.prototype.readChunk=function(){var t,e,r,i,s,n,a,o,h,f,u,l,c;if(!this.format&&this.stream.available(64)){if("caff"!==this.stream.readString(4))return this.emit("error","Invalid CAF, does not begin with 'caff'");if(this.stream.advance(4),"desc"!==this.stream.readString(4))return this.emit("error","Invalid CAF, 'caff' is not followed by 'desc'");if(0!==this.stream.readUInt32()||32!==this.stream.readUInt32())return this.emit("error","Invalid 'desc' size, should be 32");this.format={},this.format.sampleRate=this.stream.readFloat64(),this.format.formatID=this.stream.readString(4),i=this.stream.readUInt32(),"lpcm"===this.format.formatID&&(this.format.floatingPoint=Boolean(1&i),this.format.littleEndian=Boolean(2&i)),this.format.bytesPerPacket=this.stream.readUInt32(),this.format.framesPerPacket=this.stream.readUInt32(),this.format.channelsPerFrame=this.stream.readUInt32(),this.format.bitsPerChannel=this.stream.readUInt32(),this.emit("format",this.format)}for(;this.stream.available(1);){if(!this.headerCache&&(this.headerCache={type:this.stream.readString(4),oversize:0!==this.stream.readUInt32(),size:this.stream.readUInt32()},this.headerCache.oversize))return this.emit("error","Holy Shit, an oversized file, not supported in JS");switch(this.headerCache.type){case"kuki":this.stream.available(this.headerCache.size)&&("aac "===this.format.formatID?(h=this.stream.offset+this.headerCache.size,(r=p.readEsds(this.stream))&&this.emit("cookie",r),this.stream.seek(h)):(t=this.stream.readBuffer(this.headerCache.size),this.emit("cookie",t)),this.headerCache=null);break;case"pakt":if(this.stream.available(this.headerCache.size)){if(0!==this.stream.readUInt32())return this.emit("error","Sizes greater than 32 bits are not supported.");if(this.numPackets=this.stream.readUInt32(),0!==this.stream.readUInt32())return this.emit("error","Sizes greater than 32 bits are not supported.");for(this.numFrames=this.stream.readUInt32(),this.primingFrames=this.stream.readUInt32(),this.remainderFrames=this.stream.readUInt32(),this.emit("duration",this.numFrames/this.format.sampleRate*1e3|0),this.sentDuration=!0,s=l=e=0,f=this.numPackets;s<f;s+=1)this.addSeekPoint(e,l),e+=this.format.bytesPerPacket||p.readDescrLen(this.stream),l+=this.format.framesPerPacket||p.readDescrLen(this.stream);this.headerCache=null}break;case"info":for(o={},n=0,u=this.stream.readUInt32();0<=u?n<u:u<n;0<=u?++n:--n)a=this.stream.readString(null),c=this.stream.readString(null),o[a]=c;this.emit("metadata",o),this.headerCache=null;break;case"data":this.sentFirstDataChunk||(this.stream.advance(4),this.headerCache.size-=4,0===this.format.bytesPerPacket||this.sentDuration||(this.numFrames=this.headerCache.size/this.format.bytesPerPacket,this.emit("duration",this.numFrames/this.format.sampleRate*1e3|0)),this.sentFirstDataChunk=!0),t=this.stream.readSingleBuffer(this.headerCache.size),this.headerCache.size-=t.length,this.emit("data",t),this.headerCache.size<=0&&(this.headerCache=null);break;default:this.stream.available(this.headerCache.size)&&(this.stream.advance(this.headerCache.size),this.headerCache=null)}}}}.call(this)},{"../demuxer":14,"./m4a":18}],18:[function(l,c,t){!function(){var r,e,i,o,h,s,t,n,a={}.hasOwnProperty,f=[].indexOf||function(t){for(var e=0,r=this.length;e<r;e++)if(e in this&&this[e]===t)return e;return-1};function u(){return u.__super__.constructor.apply(this,arguments)}(function(t,e){for(var r in e)a.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype})(u,t=l("../demuxer")),t.register(u),e=["M4A ","M4P ","M4B ","M4V ","isom","mp42","qt  "],u.probe=function(t){return"ftyp"===t.peekString(4,4)&&(t=t.peekString(8,4),0<=f.call(e,t))},u.prototype.init=function(){return this.atoms=[],this.offsets=[],this.track=null,this.tracks=[]},o={},h={},i=function(t,e){for(var r,i=[],s=t.split(".").slice(0,-1),n=0,a=s.length;n<a;n++)r=s[n],i.push(r),h[i.join(".")]=!0;return null==o[t]&&(o[t]={}),o[t].fn=e},n=function(t,e){return null==o[t]&&(o[t]={}),o[t].after=e},u.prototype.readChunk=function(){var t,e;for(this.break=!1;this.stream.available(1)&&!this.break;){if(!this.readHeaders){if(!this.stream.available(8))return;if(this.len=this.stream.readUInt32()-8,this.type=this.stream.readString(4),0===this.len)continue;this.atoms.push(this.type),this.offsets.push(this.stream.offset+this.len),this.readHeaders=!0}if(e=this.atoms.join("."),null!=(t=o[e])&&t.fn){if(!this.stream.available(this.len)&&"mdat"!==e)return;t.fn.call(this),e in h&&(this.readHeaders=!1)}else if(e in h)this.readHeaders=!1;else{if(!this.stream.available(this.len))return;this.stream.advance(this.len)}for(;this.stream.offset>=this.offsets[this.offsets.length-1];)null!=(t=o[this.atoms.join(".")])&&t.after&&t.after.call(this),this.atoms.pop(),this.offsets.pop(),this.readHeaders=!1}},i("ftyp",function(){var t;return t=this.stream.readString(4),f.call(e,t)<0?this.emit("error","Not a valid M4A file."):this.stream.advance(this.len-4)}),i("moov.trak",function(){return this.track={},this.tracks.push(this.track)}),i("moov.trak.tkhd",function(){return this.stream.advance(4),this.stream.advance(8),this.track.id=this.stream.readUInt32(),this.stream.advance(this.len-16)}),i("moov.trak.mdia.hdlr",function(){return this.stream.advance(4),this.stream.advance(4),this.track.type=this.stream.readString(4),this.stream.advance(12),this.stream.advance(this.len-24)}),i("moov.trak.mdia.mdhd",function(){return this.stream.advance(4),this.stream.advance(8),this.track.timeScale=this.stream.readUInt32(),this.track.duration=this.stream.readUInt32(),this.stream.advance(4)}),r={ulaw:8,alaw:8,in24:24,in32:32,fl32:32,fl64:64},i("moov.trak.mdia.minf.stbl.stsd",function(){var t,e;return this.stream.advance(4),e=this.stream.readUInt32(),"soun"!==this.track.type?this.stream.advance(this.len-8):1!==e?this.emit("error","Only expecting one entry in sample description atom!"):(this.stream.advance(4),(t=this.track.format={}).formatID=this.stream.readString(4),this.stream.advance(6),this.stream.advance(2),e=this.stream.readUInt16(),this.stream.advance(6),t.channelsPerFrame=this.stream.readUInt16(),t.bitsPerChannel=this.stream.readUInt16(),this.stream.advance(4),t.sampleRate=this.stream.readUInt16(),this.stream.advance(2),1===e?(t.framesPerPacket=this.stream.readUInt32(),this.stream.advance(4),t.bytesPerFrame=this.stream.readUInt32(),this.stream.advance(4)):0!==e&&this.emit("error","Unknown version in stsd atom"),null!=r[t.formatID]&&(t.bitsPerChannel=r[t.formatID]),t.floatingPoint="fl32"===(e=t.formatID)||"fl64"===e,t.littleEndian="sowt"===t.formatID&&8<t.bitsPerChannel,"twos"===(e=t.formatID)||"sowt"===e||"in24"===e||"in32"===e||"fl32"===e||"fl64"===e||"raw "===e||"NONE"===e?t.formatID="lpcm":void 0)}),i("moov.trak.mdia.minf.stbl.stsd.alac",function(){return this.stream.advance(4),this.track.cookie=this.stream.readBuffer(this.len-4)}),i("moov.trak.mdia.minf.stbl.stsd.esds",function(){var t=this.stream.offset+this.len;return this.track.cookie=u.readEsds(this.stream),this.stream.seek(t)}),i("moov.trak.mdia.minf.stbl.stsd.wave.enda",function(){return this.track.format.littleEndian=!!this.stream.readUInt16()}),u.readDescrLen=function(t){for(var e,r=0,i=4;i--&&(r=r<<7|127&(e=t.readUInt8()),128&e););return r},u.readEsds=function(t){var e,r,i;return t.advance(4),i=t.readUInt8(),u.readDescrLen(t),3===i?(t.advance(2),128&(e=t.readUInt8())&&t.advance(2),64&e&&t.advance(t.readUInt8()),32&e&&t.advance(2)):t.advance(2),i=t.readUInt8(),u.readDescrLen(t),4===i&&(t.readUInt8(),t.advance(1),t.advance(3),t.advance(4),t.advance(4),i=t.readUInt8(),r=u.readDescrLen(t),5===i)?t.readBuffer(r):null},i("moov.trak.mdia.minf.stbl.stts",function(){var t,e,r,i;for(this.stream.advance(4),t=this.stream.readUInt32(),this.track.stts=[],e=r=0,i=t;r<i;e=r+=1)this.track.stts[e]={count:this.stream.readUInt32(),duration:this.stream.readUInt32()};return this.setupSeekPoints()}),i("moov.trak.mdia.minf.stbl.stsc",function(){var t,e,r,i;for(this.stream.advance(4),t=this.stream.readUInt32(),this.track.stsc=[],e=r=0,i=t;r<i;e=r+=1)this.track.stsc[e]={first:this.stream.readUInt32(),count:this.stream.readUInt32(),id:this.stream.readUInt32()};return this.setupSeekPoints()}),i("moov.trak.mdia.minf.stbl.stsz",function(){var t,e,r,i;if(this.stream.advance(4),this.track.sampleSize=this.stream.readUInt32(),t=this.stream.readUInt32(),0===this.track.sampleSize&&0<t)for(this.track.sampleSizes=[],e=r=0,i=t;r<i;e=r+=1)this.track.sampleSizes[e]=this.stream.readUInt32();return this.setupSeekPoints()}),i("moov.trak.mdia.minf.stbl.stco",function(){var t,e,r,i;for(this.stream.advance(4),t=this.stream.readUInt32(),this.track.chunkOffsets=[],e=r=0,i=t;r<i;e=r+=1)this.track.chunkOffsets[e]=this.stream.readUInt32();return this.setupSeekPoints()}),i("moov.trak.tref.chap",function(){var t,e,r,i=this.len>>2;for(this.track.chapterTracks=[],t=e=0,r=i;e<r;t=e+=1)this.track.chapterTracks[t]=this.stream.readUInt32()}),u.prototype.setupSeekPoints=function(){var t,e,r,i,s,n,a,o,h,f,u,l,c,p,d;if(null!=this.track.chunkOffsets&&null!=this.track.stsc&&null!=this.track.sampleSize&&null!=this.track.stts){for(d=s=f=p=c=c=l=0,this.track.seekPoints=[],h=[],t=e=0,i=(a=this.track.chunkOffsets).length;e<i;t=++e){for(n=a[t],r=0,o=this.track.stsc[l].count;r<o;r+=1)this.track.seekPoints.push({offset:s,position:n,timestamp:d}),s+=u=this.track.sampleSize||this.track.sampleSizes[f++],n+=u,d+=this.track.stts[c].duration,c+1<this.track.stts.length&&++p===this.track.stts[c].count&&(p=0,c++);l+1<this.track.stsc.length&&t+1===this.track.stsc[l+1].first?h.push(l++):h.push(void 0)}return h}},n("moov",function(){var t,e,r,i;for(null!=this.mdatOffset&&this.stream.seek(this.mdatOffset-8),t=0,e=(r=this.tracks).length;t<e;t++)if("soun"===(i=r[t]).type){this.track=i;break}return"soun"!==this.track.type?(this.track=null,this.emit("error","No audio tracks in m4a file.")):(this.emit("format",this.track.format),this.emit("duration",this.track.duration/this.track.timeScale*1e3|0),this.track.cookie&&this.emit("cookie",this.track.cookie),this.seekPoints=this.track.seekPoints)}),i("mdat",function(){var t,e,r,i,s,n,a,o,h;if(!this.startedData){if(null==this.mdatOffset&&(this.mdatOffset=this.stream.offset),0===this.tracks.length)return t=Math.min(this.stream.remainingBytes(),this.len),this.stream.advance(t),void(this.len-=t);this.chunkIndex=0,this.stscIndex=0,this.sampleIndex=0,this.tailOffset=0,this.tailSamples=0,this.startedData=!0}if(!this.readChapters){if(this.readChapters=this.parseChapters(),this.break=!this.readChapters)return;this.stream.seek(this.mdatOffset)}if(n=this.track.chunkOffsets[this.chunkIndex]+this.tailOffset,i=0,this.stream.available(n-this.stream.offset)){for(this.stream.seek(n);this.chunkIndex<this.track.chunkOffsets.length;){for(o=r=e=0,a=s=this.track.stsc[this.stscIndex].count-this.tailSamples;r<a&&(h=this.track.sampleSize||this.track.sampleSizes[this.sampleIndex],this.stream.available(i+h));o=r+=1)i+=h,e+=h,this.sampleIndex++;if(o<s){this.tailOffset+=e,this.tailSamples+=o;break}if(this.chunkIndex++,this.tailOffset=0,this.tailSamples=0,this.stscIndex+1<this.track.stsc.length&&this.chunkIndex+1===this.track.stsc[this.stscIndex+1].first&&this.stscIndex++,n+i!==this.track.chunkOffsets[this.chunkIndex])break}return 0<i?(this.emit("data",this.stream.readBuffer(i)),this.break=this.chunkIndex===this.track.chunkOffsets.length):this.break=!0}this.break=!0}),u.prototype.parseChapters=function(){var t,e,r,i,s,n,a,o,h,f;if(!(0<(null!=(n=this.track.chapterTracks)?n.length:void 0)))return!0;for(e=this.track.chapterTracks[0],r=0,i=(a=this.tracks).length;r<i&&(f=a[r]).id!==e;r++);for(f.id!==e&&this.emit("error","Chapter track does not exist."),null==this.chapters&&(this.chapters=[]);this.chapters.length<f.seekPoints.length;){if(s=f.seekPoints[this.chapters.length],!this.stream.available(s.position-this.stream.offset+32))return!1;if(this.stream.seek(s.position),o=this.stream.readUInt16(),h=null,!this.stream.available(o))return!1;2<o&&(65279!==(t=this.stream.peekUInt16())&&65534!==t||(h=this.stream.readString(o,"utf16-bom"))),null==h&&(h=this.stream.readString(o,"utf8")),o=null!=(o=null!=(o=f.seekPoints[this.chapters.length+1])?o.timestamp:void 0)?o:f.duration,this.chapters.push({title:h,timestamp:s.timestamp/f.timeScale*1e3|0,duration:(o-s.timestamp)/f.timeScale*1e3|0})}return this.emit("chapters",this.chapters),!0},i("moov.udta.meta",function(){return this.metadata={},this.stream.advance(4)}),n("moov.udta.meta",function(){return this.emit("metadata",this.metadata)}),(t=function(t,e,r){return i("moov.udta.meta.ilst."+t+".data",function(){return this.stream.advance(8),this.len-=8,r.call(this,e)})})("©alb","album",n=function(t){return this.metadata[t]=this.stream.readString(this.len,"utf8")}),t("©arg","arranger",n),t("©art","artist",n),t("©ART","artist",n),t("aART","albumArtist",n),t("catg","category",n),t("©com","composer",n),t("©cpy","copyright",n),t("cprt","copyright",n),t("©cmt","comments",n),t("©day","releaseDate",n),t("desc","description",n),t("©gen","genre",n),t("©grp","grouping",n),t("©isr","ISRC",n),t("keyw","keywords",n),t("©lab","recordLabel",n),t("ldes","longDescription",n),t("©lyr","lyrics",n),t("©nam","title",n),t("©phg","recordingCopyright",n),t("©prd","producer",n),t("©prf","performers",n),t("purd","purchaseDate",n),t("purl","podcastURL",n),t("©swf","songwriter",n),t("©too","encoder",n),t("©wrt","composer",n),t("covr","coverArt",function(t){return this.metadata[t]=this.stream.readBuffer(this.len)}),s=["Blues","Classic Rock","Country","Dance","Disco","Funk","Grunge","Hip-Hop","Jazz","Metal","New Age","Oldies","Other","Pop","R&B","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death Metal","Pranks","Soundtrack","Euro-Techno","Ambient","Trip-Hop","Vocal","Jazz+Funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound Clip","Gospel","Noise","AlternRock","Bass","Soul","Punk","Space","Meditative","Instrumental Pop","Instrumental Rock","Ethnic","Gothic","Darkwave","Techno-Industrial","Electronic","Pop-Folk","Eurodance","Dream","Southern Rock","Comedy","Cult","Gangsta","Top 40","Christian Rap","Pop/Funk","Jungle","Native American","Cabaret","New Wave","Psychadelic","Rave","Showtunes","Trailer","Lo-Fi","Tribal","Acid Punk","Acid Jazz","Polka","Retro","Musical","Rock & Roll","Hard Rock","Folk","Folk/Rock","National Folk","Swing","Fast Fusion","Bebob","Latin","Revival","Celtic","Bluegrass","Avantgarde","Gothic Rock","Progressive Rock","Psychedelic Rock","Symphonic Rock","Slow Rock","Big Band","Chorus","Easy Listening","Acoustic","Humour","Speech","Chanson","Opera","Chamber Music","Sonata","Symphony","Booty Bass","Primus","Porn Groove","Satire","Slow Jam","Club","Tango","Samba","Folklore","Ballad","Power Ballad","Rhythmic Soul","Freestyle","Duet","Punk Rock","Drum Solo","A Capella","Euro-House","Dance Hall"],t("gnre","genre",function(t){return this.metadata[t]=s[this.stream.readUInt16()-1]}),t("tmpo","tempo",function(t){return this.metadata[t]=this.stream.readUInt16()}),t("rtng","rating",function(t){var e=this.stream.readUInt8();return this.metadata[t]=2===e?"Clean":0!==e?"Explicit":"None"}),t("disk","diskNumber",n=function(t){return this.stream.advance(2),this.metadata[t]=this.stream.readUInt16()+" of "+this.stream.readUInt16(),this.stream.advance(this.len-6)}),t("trkn","trackNumber",n),t("cpil","compilation",n=function(t){return this.metadata[t]=1===this.stream.readUInt8()}),t("pcst","podcast",n),t("pgap","gapless",n),c.exports=u}.call(this)},{"../demuxer":14}],19:[function(i,t,e){!function(){var t,r,s={}.hasOwnProperty;function e(){return e.__super__.constructor.apply(this,arguments)}(function(t,e){for(var r in e)s.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype})(e,t=i("../demuxer")),t.register(e),e.probe=function(t){return"RIFF"===t.peekString(0,4)&&"WAVE"===t.peekString(8,4)},r={1:"lpcm",3:"lpcm",6:"alaw",7:"ulaw"},e.prototype.readChunk=function(){var t,e;if(!this.readStart&&this.stream.available(12)){if("RIFF"!==this.stream.readString(4))return this.emit("error","Invalid WAV file.");if(this.fileSize=this.stream.readUInt32(!0),this.readStart=!0,"WAVE"!==this.stream.readString(4))return this.emit("error","Invalid WAV file.")}for(;this.stream.available(1);){switch(!this.readHeaders&&this.stream.available(8)&&(this.type=this.stream.readString(4),this.len=this.stream.readUInt32(!0)),this.type){case"fmt ":if(!((e=this.stream.readUInt16(!0))in r))return this.emit("error","Unsupported format in WAV file.");this.format={formatID:r[e],floatingPoint:3===e,littleEndian:"lpcm"===r[e],channelsPerFrame:this.stream.readUInt16(!0),sampleRate:this.stream.readUInt32(!0),framesPerPacket:1},this.stream.advance(4),this.stream.advance(2),this.format.bitsPerChannel=this.stream.readUInt16(!0),this.format.bytesPerPacket=this.format.bitsPerChannel/8*this.format.channelsPerFrame,this.emit("format",this.format),this.stream.advance(this.len-16);break;case"data":this.sentDuration||(t=this.format.bitsPerChannel/8,this.emit("duration",this.len/t/this.format.channelsPerFrame/this.format.sampleRate*1e3|0),this.sentDuration=!0),t=this.stream.readSingleBuffer(this.len),this.len-=t.length,this.readHeaders=0<this.len,this.emit("data",t);break;default:if(!this.stream.available(this.len))return;this.stream.advance(this.len)}"data"!==this.type&&(this.readHeaders=!1)}}}.call(this)},{"../demuxer":14}],20:[function(e,r,t){!function(){var n,s={}.hasOwnProperty;function t(t,e){var r,i;this.sampleRate=t,this.channels=e,this.updateTime=(r=this.updateTime,i=this,function(){return r.apply(i,arguments)}),this.playing=!1,this.currentTime=0,this._lastTime=0}(function(t,e){for(var r in e)s.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype})(t,e("./core/events")),t.prototype.start=function(){if(!this.playing){if(this.playing=!0,null==this.device&&(this.device=t.create(this.sampleRate,this.channels)),!this.device)throw new Error("No supported audio device found.");return this._lastTime=this.device.getDeviceTime(),this._timer=setInterval(this.updateTime,200),this.device.on("refill",this.refill=(e=this,function(t){return e.emit("refill",t)}));var e}},t.prototype.stop=function(){if(this.playing)return this.playing=!1,this.device.off("refill",this.refill),clearInterval(this._timer)},t.prototype.destroy=function(){var t;return this.stop(),null!=(t=this.device)?t.destroy():void 0},t.prototype.seek=function(t){return this.currentTime=t,this.playing&&(this._lastTime=this.device.getDeviceTime()),this.emit("timeUpdate",this.currentTime)},t.prototype.updateTime=function(){var t=this.device.getDeviceTime();return this.currentTime+=(t-this._lastTime)/this.device.sampleRate*1e3|0,this._lastTime=t,this.emit("timeUpdate",this.currentTime)},n=[],t.register=function(t){return n.push(t)},t.create=function(t,e){for(var r,i=0,s=n.length;i<s;i++)if((r=n[i]).supported)return new r(t,e);return null},r.exports=t}.call(this)},{"./core/events":8}],21:[function(o,t,e){!function(){var i,t,e,s,r,n={}.hasOwnProperty;function a(t,e){var r,i;this.sampleRate=t,this.channels=e,this.refill=(r=this.refill,i=this,function(){return r.apply(i,arguments)}),this.audio=new Audio,this.audio.mozSetup(this.channels,this.sampleRate),this.writePosition=0,this.prebufferSize=this.sampleRate/2,this.tail=null,this.timer=s(this.refill,100)}e=o("../core/events"),t=o("../device"),i=o("../core/buffer"),function(t,e){for(var r in e)n.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(a,e),t.register(a),a.supported="undefined"!=typeof Audio&&null!==Audio&&"mozWriteAudio"in new Audio,a.prototype.refill=function(){var t,e;this.tail&&(e=this.audio.mozWriteAudio(this.tail),this.writePosition+=e,this.writePosition<this.tail.length?this.tail=this.tail.subarray(e):this.tail=null),0<(t=this.audio.mozCurrentSampleOffset()+this.prebufferSize-this.writePosition)&&(t=new Float32Array(t),this.emit("refill",t),(e=this.audio.mozWriteAudio(t))<t.length&&(this.tail=t.subarray(e)),this.writePosition+=e)},a.prototype.destroy=function(){return r(this.timer)},a.prototype.getDeviceTime=function(){return this.audio.mozCurrentSampleOffset()/this.channels},s=function(t,e){var r=i.makeBlobURL("setInterval(function() { postMessage('ping'); }, "+e+");");return null==r?setInterval(t,e):((e=new Worker(r)).onmessage=t,e.url=r,e)},r=function(t){return t.terminate?(t.terminate(),URL.revokeObjectURL(t.url)):clearInterval(t)}}.call(this)},{"../core/buffer":6,"../core/events":8,"../device":20}],22:[function(t,e,r){function i(t,e,r,i){this.fromSampleRate=+t,this.toSampleRate=+e,this.channels=0|r,this.inputBufferLength=i,this.initialize()}i.prototype.initialize=function(){if(!(0<this.fromSampleRate&&0<this.toSampleRate&&0<this.channels))throw new Error("Invalid settings specified for the resampler.");var t;this.fromSampleRate==this.toSampleRate?(this.resampler=this.bypassResampler,this.ratioWeight=1):(this.ratioWeight=this.fromSampleRate/this.toSampleRate,this.fromSampleRate<this.toSampleRate?(this.compileLinearInterpolationFunction(),this.lastWeight=1):(this.compileMultiTapFunction(),this.tailExists=!1,this.lastWeight=0),t=Math.ceil(this.inputBufferLength*this.toSampleRate/this.fromSampleRate/this.channels*1.01)*this.channels+this.channels,this.outputBuffer=new Float32Array(t),this.lastOutput=new Float32Array(this.channels))},i.prototype.compileLinearInterpolationFunction=function(){for(var t="var outputOffset = 0;    var bufferLength = buffer.length;    if (bufferLength > 0) {      var weight = this.lastWeight;      var firstWeight = 0;      var secondWeight = 0;      var sourceOffset = 0;      var outputOffset = 0;      var outputBuffer = this.outputBuffer;      for (; weight < 1; weight += "+this.ratioWeight+") {        secondWeight = weight % 1;        firstWeight = 1 - secondWeight;",e=0;e<this.channels;++e)t+="outputBuffer[outputOffset++] = (this.lastOutput["+e+"] * firstWeight) + (buffer["+e+"] * secondWeight);";t+="}      weight -= 1;      for (bufferLength -= "+this.channels+", sourceOffset = Math.floor(weight) * "+this.channels+"; sourceOffset < bufferLength;) {        secondWeight = weight % 1;        firstWeight = 1 - secondWeight;";for(e=0;e<this.channels;++e)t+="outputBuffer[outputOffset++] = (buffer[sourceOffset"+(0<e?" + "+e:"")+"] * firstWeight) + (buffer[sourceOffset + "+(this.channels+e)+"] * secondWeight);";t+="weight += "+this.ratioWeight+";        sourceOffset = Math.floor(weight) * "+this.channels+";      }";for(e=0;e<this.channels;++e)t+="this.lastOutput["+e+"] = buffer[sourceOffset++];";t+="this.lastWeight = weight % 1;    }    return this.outputBuffer;",this.resampler=Function("buffer",t)},i.prototype.compileMultiTapFunction=function(){for(var t="var outputOffset = 0;    var bufferLength = buffer.length;    if (bufferLength > 0) {      var weight = 0;",e=0;e<this.channels;++e)t+="var output"+e+" = 0;";for(t+="var actualPosition = 0;      var amountToNext = 0;      var alreadyProcessedTail = !this.tailExists;      this.tailExists = false;      var outputBuffer = this.outputBuffer;      var currentPosition = 0;      do {        if (alreadyProcessedTail) {          weight = "+this.ratioWeight+";",e=0;e<this.channels;++e)t+="output"+e+" = 0;";for(t+="}        else {          weight = this.lastWeight;",e=0;e<this.channels;++e)t+="output"+e+" = this.lastOutput["+e+"];";for(t+="alreadyProcessedTail = true;        }        while (weight > 0 && actualPosition < bufferLength) {          amountToNext = 1 + actualPosition - currentPosition;          if (weight >= amountToNext) {",e=0;e<this.channels;++e)t+="output"+e+" += buffer[actualPosition++] * amountToNext;";for(t+="currentPosition = actualPosition;            weight -= amountToNext;          }          else {",e=0;e<this.channels;++e)t+="output"+e+" += buffer[actualPosition"+(0<e?" + "+e:"")+"] * weight;";for(t+="currentPosition += weight;            weight = 0;            break;          }        }        if (weight <= 0) {",e=0;e<this.channels;++e)t+="outputBuffer[outputOffset++] = output"+e+" / "+this.ratioWeight+";";for(t+="}        else {          this.lastWeight = weight;",e=0;e<this.channels;++e)t+="this.lastOutput["+e+"] = output"+e+";";t+="this.tailExists = true;          break;        }      } while (actualPosition < bufferLength);    }    return this.outputBuffer;",this.resampler=Function("buffer",t)},i.prototype.bypassResampler=function(t){return t},e.exports=i},{}],23:[function(f,t,e){!function(i){!function(){var t,e,s,n,a,o,h={}.hasOwnProperty;function r(t,e){var r,i;this.sampleRate=t,this.channels=e,this.refill=(r=this.refill,i=this,function(){return r.apply(i,arguments)}),this.context=null!=o?o:o=new n,this.deviceSampleRate=this.context.sampleRate,this.bufferSize=Math.ceil(4096/(this.deviceSampleRate/this.sampleRate)*this.channels),this.bufferSize+=this.bufferSize%this.channels,this.deviceSampleRate!==this.sampleRate&&(this.resampler=new s(this.sampleRate,this.deviceSampleRate,this.channels,this.bufferSize)),this.node=this.context[a](4096,this.channels,this.channels),this.node.onaudioprocess=this.refill,this.node.connect(this.context.destination)}e=f("../core/events"),t=f("../device"),s=f("./resampler"),function(t,e){for(var r in e)h.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(r,e),t.register(r),n=i.AudioContext||i.webkitAudioContext,r.supported=n&&("function"==typeof n.prototype[a="createScriptProcessor"]||"function"==typeof n.prototype[a="createJavaScriptNode"]),o=null,r.prototype.refill=function(t){for(var e,r,i,s,n,a,o,h=t.outputBuffer,f=h.numberOfChannels,u=new Array(f),l=r=0,c=f;r<c;l=r+=1)u[l]=h.getChannelData(l);for(e=new Float32Array(this.bufferSize),this.emit("refill",e),this.resampler&&(e=this.resampler.resampler(e)),l=i=0,a=h.length;i<a;l=i+=1)for(n=s=0,o=f;s<o;n=s+=1)u[n][l]=e[l*f+n]},r.prototype.destroy=function(){return this.node.disconnect(0)},r.prototype.getDeviceTime=function(){return this.context.currentTime*this.sampleRate}}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../core/events":8,"../device":20,"./resampler":22}],24:[function(t,e,r){!function(){function t(t,e){t&&e&&Object.defineProperty(this,"value",{get:function(){return t[e]}})}t.prototype.process=function(t){},e.exports=t}.call(this)},{}],25:[function(e,r,t){!function(){var s={}.hasOwnProperty;function t(){return t.__super__.constructor.apply(this,arguments)}(function(t,e){for(var r in e)s.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype})(t,e("../filter")),t.prototype.process=function(t){var e,r,i,s;if(0!==this.value)for(i=Math.max(-50,Math.min(50,this.value)),e=r=0,s=t.length;r<s;e=r+=2)t[e]*=Math.min(1,(50-i)/50),t[e+1]*=Math.min(1,(50+i)/50)},r.exports=t}.call(this)},{"../filter":24}],26:[function(e,r,t){!function(){var s={}.hasOwnProperty;function t(){return t.__super__.constructor.apply(this,arguments)}(function(t,e){for(var r in e)s.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype})(t,e("../filter")),t.prototype.process=function(t){var e,r,i,s;if(!(100<=this.value))for(s=Math.max(0,Math.min(100,this.value))/100,e=r=0,i=t.length;r<i;e=r+=1)t[e]*=s},r.exports=t}.call(this)},{"../filter":24}],27:[function(n,a,t){!function(){var r,t,f,e,u,l,s={}.hasOwnProperty;function i(t){var e,r,i,s,n,a,o,h;this.asset=t,this.startPlaying=(e=this.startPlaying,r=this,function(){return e.apply(r,arguments)}),this.playing=!1,this.buffered=0,this.currentTime=0,this.duration=0,this.volume=100,this.pan=0,this.metadata={},this.filters=[new l(this,"volume"),new f(this,"pan")],this.asset.on("buffer",(i=this,function(t){return i.buffered=t,i.emit("buffer",i.buffered)})),this.asset.on("decodeStart",(s=this,function(){return s.queue=new u(s.asset),s.queue.once("ready",s.startPlaying)})),this.asset.on("format",(n=this,function(t){return n.format=t,n.emit("format",n.format)})),this.asset.on("metadata",(a=this,function(t){return a.metadata=t,a.emit("metadata",a.metadata)})),this.asset.on("duration",(o=this,function(t){return o.duration=t,o.emit("duration",o.duration)})),this.asset.on("error",(h=this,function(t){return h.emit("error",t)}))}e=n("./core/events"),r=n("./asset"),l=n("./filters/volume"),f=n("./filters/balance"),u=n("./queue"),t=n("./device"),function(t,e){for(var r in e)s.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(i,e),i.fromURL=function(t,e){return new i(r.fromURL(t,e))},i.fromFile=function(t){return new i(r.fromFile(t))},i.fromBuffer=function(t){return new i(r.fromBuffer(t))},i.prototype.preload=function(){if(this.asset)return this.startedPreloading=!0,this.asset.start(!1)},i.prototype.play=function(){var t;if(!this.playing)return this.startedPreloading||this.preload(),this.playing=!0,null!=(t=this.device)?t.start():void 0},i.prototype.pause=function(){var t;if(this.playing)return this.playing=!1,null!=(t=this.device)?t.stop():void 0},i.prototype.togglePlayback=function(){return this.playing?this.pause():this.play()},i.prototype.stop=function(){var t;return this.pause(),this.asset.stop(),null!=(t=this.device)?t.destroy():void 0},i.prototype.seek=function(t){var e,r;return null!=(e=this.device)&&e.stop(),this.queue.once("ready",(r=this,function(){var t;if(null!=(t=r.device)&&t.seek(r.currentTime),r.playing)return null!=(t=r.device)?t.start():void 0})),t=t/1e3*this.format.sampleRate,t=this.asset.decoder.seek(t),this.currentTime=t/this.format.sampleRate*1e3|0,this.queue.reset(),this.currentTime},i.prototype.startPlaying=function(){var e,o,h=this.queue.read(),f=0;return this.device=new t(this.format.sampleRate,this.format.channelsPerFrame),this.device.on("timeUpdate",(e=this,function(t){return e.currentTime=t,e.emit("progress",e.currentTime)})),this.refill=(o=this,function(t){var e,r,i,s,n,a;if(o.playing){for(h||(h=o.queue.read(),f=0),e=0;h&&e<t.length;){for(r=0,n=Math.min(h.length-f,t.length-e);r<n;r+=1)t[e++]=h[f++];f===h.length&&(h=o.queue.read(),f=0)}for(i=0,s=(a=o.filters).length;i<s;i++)a[i].process(t);h||(o.queue.ended?(o.currentTime=o.duration,o.emit("progress",o.currentTime),o.emit("end")):o.device.stop())}}),this.device.on("refill",this.refill),this.playing&&this.device.start(),this.emit("ready")},i.prototype.destroy=function(){var t;return this.stop(),null!=(t=this.device)&&t.off(),null!=(t=this.asset)&&t.destroy(),this.off()},a.exports=i}.call(this)},{"./asset":1,"./core/events":8,"./device":20,"./filters/balance":25,"./filters/volume":26,"./queue":28}],28:[function(e,r,t){!function(){var s={}.hasOwnProperty;function t(t){var e,r,i;this.asset=t,this.write=(e=this.write,r=this,function(){return e.apply(r,arguments)}),this.readyMark=32,this.finished=!1,this.buffering=!0,this.ended=!1,this.buffers=[],this.asset.on("data",this.write),this.asset.on("end",(i=this,function(){return i.ended=!0})),this.asset.decodePacket()}(function(t,e){for(var r in e)s.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype})(t,e("./core/events")),t.prototype.write=function(t){if(t&&this.buffers.push(t),this.buffering)return this.buffers.length>=this.readyMark||this.ended?(this.buffering=!1,this.emit("ready")):this.asset.decodePacket()},t.prototype.read=function(){return 0===this.buffers.length?null:(this.asset.decodePacket(),this.buffers.shift())},t.prototype.reset=function(){return this.buffers.length=0,this.buffering=!0,this.asset.decodePacket()},r.exports=t}.call(this)},{"./core/events":8}],29:[function(t,e,r){var s,i,n={}.hasOwnProperty;function a(t){if(this.file=t,"undefined"==typeof FileReader||null===FileReader)return this.emit("error","This browser does not have FileReader support.");this.offset=0,this.length=this.file.size,this.chunkSize=1<<20,this.file[this.slice="slice"]||this.file[this.slice="webkitSlice"]||this.file[this.slice="mozSlice"]}i=t("../../core/events"),s=t("../../core/buffer"),function(t,e){for(var r in e)n.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(a,i),a.prototype.start=function(){return this.reader&&!this.active||(this.reader=new FileReader,this.active=!0,this.reader.onload=(e=this,function(t){t=new s(new Uint8Array(t.target.result));if(e.offset+=t.length,e.emit("data",t),e.active=!1,e.offset<e.length)return e.loop()}),this.reader.onloadend=(t=this,function(){if(t.offset===t.length)return t.emit("end"),t.reader=null}),this.reader.onerror=(r=this,function(t){return r.emit("error",t)}),this.reader.onprogress=(i=this,function(t){return i.emit("progress",(i.offset+t.loaded)/i.length*100)})),this.loop();var e,t,r,i},a.prototype.loop=function(){var t;return this.active=!0,t=Math.min(this.offset+this.chunkSize,this.length),t=this.file[this.slice](this.offset,t),this.reader.readAsArrayBuffer(t)},a.prototype.pause=function(){var t;this.active=!1;try{return null!=(t=this.reader)?t.abort():void 0}catch(t){}},a.prototype.reset=function(){return this.pause(),this.offset=0},e.exports=a},{"../../core/buffer":6,"../../core/events":8}],30:[function(t,e,r){var h,i,s={}.hasOwnProperty;function n(t,e){this.url=t,this.opts=null!=e?e:{},this.chunkSize=1<<20,this.inflight=!1,this.opts.length&&(this.length=this.opts.length),this.reset()}i=t("../../core/events"),h=t("../../core/buffer"),function(t,e){for(var r in e)s.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(n,i),n.prototype.start=function(){return this.length&&!this.inflight?this.loop():(this.inflight=!0,this.xhr=new XMLHttpRequest,this.xhr.onload=(e=this,function(t){return e.length=parseInt(e.xhr.getResponseHeader("Content-Length")),e.inflight=!1,e.loop()}),this.xhr.onerror=(r=this,function(t){return r.pause(),r.emit("error",t)}),this.xhr.onabort=(i=this,function(t){return i.inflight=!1}),this.xhr.open("HEAD",this.url,!0),this.xhr.send(null));var e,r,i},n.prototype.loop=function(){var t,o,e,r,i;return this.inflight||!this.length?this.emit("error","Something is wrong in HTTPSource.loop"):(this.inflight=!0,this.xhr=new XMLHttpRequest,this.xhr.onload=(o=this,function(t){var e,r,i,s,n,a;if(o.xhr.response)e=new Uint8Array(o.xhr.response);else for(s=o.xhr.responseText,e=new Uint8Array(s.length),i=n=0,a=s.length;0<=a?n<a:a<n;i=0<=a?++n:--n)e[i]=255&s.charCodeAt(i);if(r=new h(e),o.offset+=r.length,o.emit("data",r),o.offset>=o.length&&o.emit("end"),o.inflight=!1,!(o.offset>=o.length))return o.loop()}),this.xhr.onprogress=(e=this,function(t){return e.emit("progress",(e.offset+t.loaded)/e.length*100)}),this.xhr.onerror=(r=this,function(t){return r.emit("error",t),r.pause()}),this.xhr.onabort=(i=this,function(t){return i.inflight=!1}),this.xhr.open("GET",this.url,!0),this.xhr.responseType="arraybuffer",t=Math.min(this.offset+this.chunkSize,this.length-1),this.xhr.setRequestHeader("If-None-Match","webkit-no-cache"),this.xhr.setRequestHeader("Range","bytes="+this.offset+"-"+t),this.xhr.overrideMimeType("text/plain; charset=x-user-defined"),this.xhr.send(null))},n.prototype.pause=function(){var t;return this.inflight=!1,null!=(t=this.xhr)?t.abort():void 0},n.prototype.reset=function(){return this.pause(),this.offset=0},e.exports=n},{"../../core/buffer":6,"../../core/events":8}],31:[function(h,f,t){!function(o){!function(){var i,s,t,e,r,n={}.hasOwnProperty;function a(t){var e,r;this.loop=(e=this.loop,r=this,function(){return e.apply(r,arguments)}),t instanceof s?this.list=t:(this.list=new s,this.list.append(new i(t))),this.paused=!0}t=h("../core/events"),s=h("../core/bufferlist"),i=h("../core/buffer"),function(t,e){for(var r in e)n.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(a,t),r=o.setImmediate||function(t){return o.setTimeout(t,0)},e=o.clearImmediate||function(t){return o.clearTimeout(t)},a.prototype.start=function(){return this.paused=!1,this._timer=r(this.loop)},a.prototype.loop=function(){return this.emit("progress",(this.list.numBuffers-this.list.availableBuffers+1)/this.list.numBuffers*100|0),this.emit("data",this.list.first),this.list.advance()?r(this.loop):this.emit("end")},a.prototype.pause=function(){return e(this._timer),this.paused=!0},a.prototype.reset=function(){return this.pause(),this.list.rewind()},a.prototype.append=function(t){this.list.append(new i(t)),this.loop()},f.exports=a}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../core/buffer":6,"../core/bufferlist":7,"../core/events":8}],32:[function(t,e,r){var i,s,n=t("./src/aurora");for(i in n)s=n[i],r[i]=s;t("./src/devices/webaudio"),t("./src/devices/mozilla")},{"./src/aurora":2,"./src/devices/mozilla":21,"./src/devices/webaudio":23}]},{},[32])(32)});