$(commonInit(loadLoginResources));function loadLoginResources(){toCss(["/login.css?ver=","/statics/css/theme.css?ver="],versionconfig.web_version);toScript([],function(){loginInit()},versionconfig.web_version)}function loginInit(){initDot();window.api=new api();setTitle(lang.login);$(".footer").html(styleConf.sign);setCookie("updateTips","true");deleteCookie(USER_NAME);removeStorageItem("upgrade");$("#lang").val(getLang()).change(function(){setLang($(this).val(),24*365);reload()});$(".J-login-frame input[type=password]").keyup(function(a){if(a.keyCode==KEY_ENTER){$(".J-login-btn").click()}});$(".J-input").on("click",function(){$(this).val("")});$(".J-login-btn").on("click",function(){login()});$(".logining-btn").hover(function(){var a="#"+changeHexadecimalColor(styleConf.webColor.slice(0,2),47)+changeHexadecimalColor(styleConf.webColor.slice(2,4),41)+changeHexadecimalColor(styleConf.webColor.slice(4,6),42);$(this).css("background-color",a)},function(){$(this).css("background-color","#"+styleConf.webColor)});$(".logining-btn").focus(function(){var a="#"+changeHexadecimalColor(styleConf.webColor.slice(0,2),-45)+changeHexadecimalColor(styleConf.webColor.slice(2,4),16)+changeHexadecimalColor(styleConf.webColor.slice(4,6),9);$(this).css("background-color",a);$(".logining-btn").blur()});setLoginFramePosition()}function login(c,b,a){!c&&(c=$("#userName").val());!b&&(b=$("#pwd").val());!a&&(a=$("#lang").val());if(c==""){return alert(lang.alertLoginErr)}api.getCapabilities(REQUEST_GET,{username:c},function(h,i){var d=roundOne();var g=loginRoundTwo(c,i.param.salt,d[0],b);var f=roundThree(g,i.param.challenge);if(i.param.enableIteration){f=roundFour(i.param.iterations,f)}var e={username:c,loginEncryptionType:i.encryptionType[0],password:f,sessionID:i.sessionID,datetime:d[1]};api.login(REQUEST_SET,e,function(j,k){loading(false);if(j!=CODE_SUCCESS){return alert(lang.alertLoginErr)}setAuth();setStorageItem(USER_INFO,setAuthInfo(b));var l=k.cookie.split("=");setCookie(l[0],l[1]);setCookie(USER_NAME,c);setLang(a,{hoursToLive:24*7});setStorageItem(AUTH_HEADER+getDeviceVerification(),setSessionSign(l[0]));if(c==="root"){return}if(getStorageItem("isIvms")){return toMainPage()}if(passwordLevel(b)){deleteCookie("adminWeekPwd");toMainPage()}else{alertDialog()}})})}function alertDialog(){$(".J-password-tip").show().children().position({of:$("body"),at:"center",my:"center top"});$(".J-edit-ok").focus().click(function(){if($("#userName").val()==="admin"){setCookie("editPassword",true);getUserName()==="admin"&&setCookie("adminWeekPwd","1");toMainPage()}});$(".J-edit-cancel").click(function(){getUserName()==="admin"&&setCookie("adminWeekPwd","1");toMainPage()})}function toMainPage(){window.location.href=URL_FRAME}function changeHexadecimalColor(a,b){decimalVal=parseInt(a,16)+b;return("00"+(decimalVal>255?255:(decimalVal<0?0:decimalVal)).toString(16)).slice(-2)}function setLoginFramePosition(){$(".login-frame").css({"margin-top":styleConf.loginFrameMarginTop+"px","margin-right":styleConf.loginFrameMarginRight+"px"})};